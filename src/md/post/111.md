---
layout: ./src/html/post.pug
page_type: "post"
page_datetime: "2021-03-22T09:46:45"
page_id: "111"
page_tag:
  - "HTML"
page_cover: ""
page_description: "なんでだよ。普通に空にできろよ。"
page_title: "div要素やspan要素は中身を空にできないが、空になってしまうのは良い"
---

レイアウトや装飾目的で、中身のない div 要素や span 要素、いわゆる「空 div」「空 span」を作ることはままある。しかしそれは仕様として妥当なのだろうか？　結論は表題で出ている通りなのだが、一旦この記事にお付き合いいただきたい。

---

現在、唯一の HTML 仕様となった WHATWG HTML Standard では、div 要素のカテゴリーは「フローコンテンツ」と「パルパブルコンテンツ」である。

[HTML Standard - 4.4.15 The div element](https://html.spec.whatwg.org/multipage/grouping-content.html#the-div-element)

span 要素のカテゴリーは「フローコンテンツ」と「フレージングコンテンツ」と「パルパブルコンテンツ」である。

[HTML Standard - 4.5.26 The span element](https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-span-element)

コンテンツモデルとは、その要素がなんの要素やどんなテキストを内容できるかを定義したものである。似た特性は 1 つのグループにまとめられており、先述の「フローコンテンツ」とか「パルパブルコンテンツ」とかはそのうちの 1 つである。他のグループは次のリンク先で確認できる。どのグループにも含まれない固有のコンテンツモデルが指定されている要素もある。その場合グループ名は使われず、コンテンツモデルとなる条件を文章で解説していることが多い。

[HTML Standard - 3.2.5.2 Kinds of content](https://html.spec.whatwg.org/multipage/dom.html#kinds-of-content)

カテゴリーとは、その要素がどのコンテンツモデルに属しているかを定義したものである。複数のカテゴリーに属する要素もあるし、どのカテゴリーにも属さない要素もある。属するカテゴリーで語られるコンテンツモデルは、必然的にグルーピングされたコンテンツモデルになっている。名前がついていないコンテンツモデルに「属している」とは定義できないからであろう。

属するカテゴリーと内包できるコンテンツモデル、そしてその要素自身の特性によって、例えば title 要素では「head 要素内にしか書けない」「title 要素はドキュメント内に 1 つだけ」「内容物が空白文字のみは認められない」とかいう仕様を説明できるようになる。

属するものの説明と内包できるものの説明の両方でコンテンツモデルという言葉が使われているのがややこしい。

<aside>
<a href="https://www.mitsue.co.jp/knowledge/blog/frontend/202102/08_0910.html">W3C発行のHTMLがすべて廃止された日 | フロントエンドBlog | ミツエーリンクス</a>の記事にある通り、W3Cが過去に発行したHTMLの仕様は全て廃止され、WHATWGのHTML Standardだけが有効なHTML仕様となっている。ブラウザをはじめとするUAが廃止された仕様をどのように扱うかはベンダー次第と言ったところだろうが、ともかく今後もHTMLサポートをするとなった場合に参照される仕様書はWHATWGのものとなるわけで、ウェブサイト制作に携わる者も同じくWHATWGのHTML Standardに基づいて物事を判断していかなくてはならない。
</aside>

## フローコンテンツ

フローコンテンツの仕様を原文と意訳を併記してみた。引用ブロックが原文、ダブルクォーテーションが意訳である。

[HTML Standard - 3.2.5.2.2 Flow content](https://html.spec.whatwg.org/multipage/dom.html#phrasing-content)

> Most elements that are used in the body of documents and applications are categorized as flow content.

“ドキュメントの本文で使われるほとんどの要素はフローコンテンツに属している。”

> → `a`, `abbr`, `address`, `area` (if it is a descendant of a `map` element), `article`, `aside`, `audio`, `b`, `bdi`, `bdo`, `blockquote`, `br`, `button`, `canvas`, `cite`, `code`, `data`, `datalist`, `del`, `details`, `dfn`, `dialog`, `div`, `dl`, `em`, `embed`, `fieldset`, `figure`, `footer`, `form`, `h1`, `h2`, `h3`, `h4`, `h5`, `h6`, `header`, `hgroup`, `hr`, `i`, `iframe`, `img`, `input`, `ins`, `kbd`, `label`, `link` (if it is [allowed in the body](https://html.spec.whatwg.org/multipage/semantics.html#allowed-in-the-body)), `main` (if it is a [hierarchically correct `main` element](https://html.spec.whatwg.org/multipage/grouping-content.html#hierarchically-correct-main-element)), `map`, `mark`, [MathML `math`](https://www.w3.org/Math/draft-spec/chapter2.html#interf.toplevel), `menu`, `meta` (if the `itemprop` attribute is present), `meter`, `nav`, `noscript`, `object`, `ol`, `output`, `p`, `picture`, `pre`, `progress`, `q`, `ruby`, `s`, `samp`, `script`, `section`, `select`, `slot`, `small`, `span`, `strong`, `sub`, `sup`, [SVG `svg`](https://svgwg.org/svg2-draft/struct.html#SVGElement), `table`, `template`, `textarea`, `time`, `u`, `ul`, `var`, `video`, `wbr`, [autonomous custom elements](https://html.spec.whatwg.org/multipage/custom-elements.html#autonomous-custom-element), [text](https://html.spec.whatwg.org/multipage/dom.html#text-content)

ここは訳はいらないだろう。着目すべきは最後の「text」部分。これは後述、先にフレージングコンテンツを見ていく。

## フレージングコンテンツ

[HTML Standard - 3.2.5.2.5 Phrasing content](https://html.spec.whatwg.org/multipage/dom.html#phrasing-content)

> Phrasing content is the text of the document, as well as elements that mark up that text at the intra-paragraph level. Runs of [phrasing content](https://html.spec.whatwg.org/multipage/dom.html#phrasing-content-2) form [paragraphs](https://html.spec.whatwg.org/multipage/dom.html#paragraph).

"フレーズコンテンツはドキュメントのテキストで、段落内のレベルでそのテキストをマークアップする要素でもある。一連のフレージングコンテンツが段落を形成する。"

> → `a`, `abbr`, `area` (if it is a descendant of a `map` element), `audio`, `b`, `bdi`, `bdo`, `br`, `button`, `canvas`, `cite`, `code`, `data`, `datalist`, `del`, `dfn`, `em`, `embed`, `i`, `iframe`, `img`, `input`, `ins`, `kbd`, `label`, `link` (if it is [allowed in the body](https://html.spec.whatwg.org/#allowed-in-the-body)), `map`, `mark`, [MathML `math`](https://www.w3.org/Math/draft-spec/chapter2.html#interf.toplevel), `meta` (if the `itemprop` attribute is present), `meter`, `noscript`, `object`, `output`, `picture`, `progress`, `q`, `ruby`, `s`, `samp`, `script`, `select`, `slot`, `small`, `span`, `strong`, `sub`, `sup`, [SVG `svg`](https://svgwg.org/svg2-draft/struct.html#SVGElement), `template`, `textarea`, `time`, `u`, `var`, `video`, `wbr`, [autonomous custom elements](https://html.spec.whatwg.org/#autonomous-custom-element), [text](https://html.spec.whatwg.org/#text-content)

いろいろ書いてあるがここでも最後に「text」がある。

> Note: Most elements that are categorized as phrasing content can only contain elements that are themselves categorized as phrasing content, not any flow content.

"フレージングコンテンツに属する要素のほとんどは、フレージングコンテンツに属する要素だけを内包でき、フローコンテンツは内包できない。"

ここまで見ると、フローコンテンツは自身を入れ子にできるしフレージングコンテンツも自身を入れ子にできるが、フレージングコンテンツの中にフローコンテンツは入れらないとわかる。 `div > div`、 `div > span`、 `span > span` はできるが `span > div` はできないとなる。

## コンテンツモデルにおける text

そして <q lang="en">text</q> について。これにもちゃんと定義がある。

[HTML Standard - 3.2.5.2.5 Phrasing Content - Text](https://html.spec.whatwg.org/multipage/dom.html#text-content)

> Text, in the context of content models, means either nothing, or `Text` nodes. [Text](https://html.spec.whatwg.org/multipage/dom.html#text-content) is sometimes used as a content model on its own, but is also [phrasing content](https://html.spec.whatwg.org/multipage/dom.html#phrasing-content-2), and can be [inter-element whitespace](https://html.spec.whatwg.org/multipage/dom.html#inter-element-whitespace) (if the `Text` nodes are empty or contain just [ASCII whitespace](https://infra.spec.whatwg.org/#ascii-whitespace)).

“コンテンツモデル文脈のテキストは、何も意味しないかテキストノードを意味する。テキストはそれ自体でコンテンツモデルとして使われることがあるが、さらにフレージングコンテンツでもあり、要素間の空白になることもできる（テキストノードが空であるか、ただの ASCII 空白文字の場合）”

> `Text` nodes and attribute values must consist of [scalar values](https://infra.spec.whatwg.org/#scalar-value), excluding [noncharacters](https://infra.spec.whatwg.org/#noncharacter), and [controls](https://infra.spec.whatwg.org/#control) other than [ASCII whitespace](https://infra.spec.whatwg.org/#ascii-whitespace). This specification includes extra constraints on the exact value of `Text` nodes and attribute values depending on their precise context.

ここは難しいな……。

“テキストノードと属性値は、noncharactor と ASCII 空白文字以外の制御文字を除くスカラー値で構成されている必要がある。この仕様には、的確な文脈に応じたテキストノードと属性値の正確な値に対する追加の制約が含まれている。”

noncharactor と ASCII 空白文字以外の制御文字は、テキストノードと属性値にしてはいけないと読める。“的確な文脈に応じた〜追加の制約が含まれている” とはテキストノードや属性値に記述できる文字は要素や属性によって別のルールが追加されることもあるよという話だろうか？　簡単なところだと `href`に指定できる文字列には確かに「noncharactor と ASCII 空白文字以外の制御文字」の他にも、リンクとして有効な文字列であるという制約がある。そういう話だよね？　解釈が違っていたら教えてください……。

とりあえず、ASCII 空白文字ならテキストノードとして扱えるということがわかる。ASCII 空白文字の定義は、

[Infra Standard - 4.5. Code Poinsts - ASCII Whitespace](https://infra.spec.whatwg.org/#ascii-whitespace)

> ASCII whitespace is U+0009 TAB, U+000A LF, U+000C FF, U+000D CR, or U+0020 SPACE.

“ASCII 空白文字とは、タブ記号、LF 改行コード、フォームフィード、キャリッジリターン、半角スペースである。”

とのことなので、それらがフローコンテンツやフレージングコンテンツに内包してよい空白の定義となる。

重要なのは、フローコンテンツでもフレージングコンテンツでも、**中身を空にしていいとは定義されていない**、ということだ。

## "nothing" コンテンツモデル

ちなみに今回の div や span の話とは関係ないが、テキストを何も内包できない場合は "nothing" と書かれる。これは「"nothing" コンテンツモデル」という名前で定義されている。

[HTML Standard - 3.2.5.1 The "nothing" content model](https://html.spec.whatwg.org/multipage/dom.html#the-nothing-content-model)

> When an element's content model is nothing, the element must contain no `Text` nodes (other than [inter-element whitespace](https://html.spec.whatwg.org/multipage/dom.html#inter-element-whitespace)) and no element nodes.

“コンテンツモデルが "nothing" である要素は、要素間の空白文字以外、テキストノードも要素も含んではならない。”

> Note: Most HTML elements whose content model is "nothing" are also, for convenience, void elements (elements that have no end tag in the HTML syntax). However, these are entirely separate concepts.

“便宜上、コンテンツモデルが "nothing" である HTML 要素のほとんどは、HTML 構文で終了タグを持たない空要素である。ただしこれは完全に別の概念である。”

"nothing" コンテンツモデルである要素はだいたいが空要素なんだけど、空要素と "nothing" コンテンツモデルは別の世界観の話だよ、ということメモかな。

## 仕様上のパルパブルコンテンツ

次にパルパブルコンテンツについて見てみる。こちらは意訳ではなく直訳を原文と併記した。

[HTML Standard - 3.2.5.2.8 Palpable content](https://html.spec.whatwg.org/multipage/dom.html#palpable-content)

> As a general rule, elements whose content model allows any [flow content](https://html.spec.whatwg.org/multipage/dom.html#flow-content-2) or [phrasing content](https://html.spec.whatwg.org/multipage/dom.html#phrasing-content-2) should have at least one node in its [contents](https://html.spec.whatwg.org/multipage/dom.html#concept-html-contents) that is palpable content and that does not have the `hidden` attribute specified.

“原則として、コンテンツモデルがフローコンテンツかフレージングコンテンツを許容している要素は、触知可能でありそして hidden 属性が指定されていないコンテンツが少なくとも 1 つ含まれている必要がある。”

> Note: [Palpable content](https://html.spec.whatwg.org/multipage/dom.html#palpable-content-2) _makes an element non-empty by providing either some descendant non-empty_ [text](https://html.spec.whatwg.org/multipage/dom.html#text-content)_, or else something users can hear (_`audio` _elements) or view (_`video` _or_ `img` _or_ `canvas` _elements) or otherwise interact with (for example, interactive form controls)._

“パルパブルコンテンツは、空ではない子孫テキスト、またはユーザーが聞くことができるもの（audio 要素）、または見ることができるもの（video 要素か img 要素か canvas 要素）、またはその他の方法で相互にやりとりできるもの（例えばインタラクティブなフォームコントロール）を提供することで、要素を空にしない。”

> This requirement is not a hard requirement, however, as there are many cases where an element can be empty legitimately, for example when it is used as a placeholder which will later be filled in by a script, or when the element is part of a template and would on most pages be filled in but on some pages is not relevant.

“ただし、要素が合法的に空になる可能性が多いため、この要件は強く要求するものではない。例えば、あとからスクリプトで埋められるプレースホルダーとして使われたり、要素がテンプレートの一部としてほとんどのページで使われるがいくつかのページでは関連がない場合がある。”

> Conformance checkers are encouraged to provide a mechanism for authors to find elements that fail to fulfill this requirement, as an authoring aid.

“適合性チェッカーは、作者がこの要件を満たしていない要素を見つけるためのメカニズムを作成支援として提供することを勧める。”

> The following elements are palpable content:
> `a`, `abbr`, `address`, `article`, `aside`, `audio` (if the `controls` attribute is present), `b`, `bdi`, `bdo`, `blockquote`, `button`, `canvas`, `cite`, `code`, `data`, `details`, `dfn`, `div`, `dl` (if the element's children include at least one name-value group), `em`, `embed`, `fieldset`, `figure`, `footer`, `form`, `h1`, `h2`, `h3`, `h4`, `h5`, `h6`, `header`, `hgroup`, `i`, `iframe`, `img`, `input` (if the `type` attribute is _not_ in the [Hidden](<https://html.spec.whatwg.org/multipage/input.html#hidden-state-(type=hidden)>) state), `ins`, `kbd`, `label`, `main`, `map`, `mark`, [MathML `math`](https://www.w3.org/Math/draft-spec/chapter2.html#interf.toplevel), `menu` (if the element's children include at least one `li` element), `meter`, `nav`, `object`, `ol` (if the element's children include at least one `li` element), `output`, `p`, `pre`, `progress`, `q`, `ruby`, `s`, `samp`, `section`, `select`, `small`, `span`, `strong`, `sub`, `sup`, [SVG `svg`](https://svgwg.org/svg2-draft/struct.html#SVGElement), `table`, `textarea`, `time`, `u`, `ul` (if the element's children include at least one `li` element), `var`, `video`, [autonomous custom elements](https://html.spec.whatwg.org/multipage/custom-elements.html#autonomous-custom-element), [text](https://html.spec.whatwg.org/multipage/dom.html#text-content) that is not [inter-element whitespace](https://html.spec.whatwg.org/multipage/dom.html#inter-element-whitespace)> `a`, `abbr`, `address`, `article`, `aside`, `audio` (if the `controls` attribute is present), `b`, `bdi`, `bdo`, `blockquote`, `button`, `canvas`, `cite`, `code`, `data`, `details`, `dfn`, `div`, `dl` (if the element's children include at least one name-value group), `em`, `embed`, `fieldset`, `figure`, `footer`, `form`, `h1`, `h2`, `h3`, `h4`, `h5`, `h6`, `header`, `hgroup`, `i`, `iframe`, `img`, `input` (if the `type` attribute is _not_ in the [Hidden](<https://html.spec.whatwg.org/multipage/input.html#hidden-state-(type=hidden)>) state), `ins`, `kbd`, `label`, `main`, `map`, `mark`, [MathML `math`](https://www.w3.org/Math/draft-spec/chapter2.html#interf.toplevel), `menu` (if the element's children include at least one `li` element), `meter`, `nav`, `object`, `ol` (if the element's children include at least one `li` element), `output`, `p`, `pre`, `progress`, `q`, `ruby`, `s`, `samp`, `section`, `select`, `small`, `span`, `strong`, `sub`, `sup`, [SVG `svg`](https://svgwg.org/svg2-draft/struct.html#SVGElement), `table`, `textarea`, `time`, `u`, `ul` (if the element's children include at least one `li` element), `var`, `video`, [autonomous custom elements](https://html.spec.whatwg.org/multipage/custom-elements.html#autonomous-custom-element), [text](https://html.spec.whatwg.org/multipage/dom.html#text-content) that is not [inter-element whitespace](https://html.spec.whatwg.org/multipage/dom.html#inter-element-whitespace)

“次の要素が触知可能なコンテンツである: a, abbr, address, article, aside, audio（controls 属性があれば）, b, bdi, bdo, blockquote, button, canvas, cite, code, data, details, dfn, div, dl（子要素に少なくとも 1 つの dt と dd のグループがあれば）, em, embed, fieldset, figure, footer, form, h1, h2, h3, h4, h5, h6, header, hgroup, i, iframe, img, input（type 属性が hidden ではなければ）, ins, kbd, label, main, map, mark, MathML math, menu（少なくとも 1 つの li 要素があれば）, meter, nav, object, ol（少なくとも 1 つの li 要素があれば）, output, p, pre, progress, q, ruby, s, samp, section, select, small, span, strong, sub, sup, SVG svg, table, textarea, time, u, ul（少なくとも 1 つの li 要素があれば）, var, video, 自律的なカスタムエレメント、要素間のスペースではないテキスト”

なるほだない。

## 意訳したパルバブルコンテンツ

意訳してみた。

“原則として、パルパブルコンテンツのカテゴリーに属する要素のコンテンツモデルが、フローコンテンツかフレージングコンテンを許容する場合は、その中身には触知可能なコンテンツが最低でも 1 つ含まれなくてはならないし、そのコンテンツに hidden 属性があってはならない。”

“パルパブルコンテンツは、読む・聞く・見る・入力するのいずれかができる要素を提供するので空にならない。”

“ただし、あとからスクリプトで挿入されるから中身が空である場合や、ほとんどのページでテンプレート的に使われる要素だけど一部のページでは関係ないゆえに中身が空になっている場合など、合法的に空なる可能性があるから、中身が空ではいけないという仕様は強く求める要件ではない。”

“チェックツールは要素が合法的に空であるのかそうでないのかを検出する機能を提供することを推奨する。”

前半 2 つのパラグラフは意訳しなくてもいい程度には特に問題なく理解できる。ある要素がパルパブルコンテンツであり、かつコンテンツモデルがフローコンテンツかフレージングコンテンツである場合は、中には意味のある何かが書かれている必要があるよ、その何かは hidden 属性が付いてたらだめだよ、その何かは読むか聞くか見るか入力するのどれかができる要素だよ、そういう要素が書かれているからパルパブルコンテンツの中身が空になることはないんだよ、という説明だろう。テキスト・音声・画像・動画・canvas・インタラクティブ要素をまとめて触知可能と言っているのはちょっとオシャレだなと思う。

なるほだないのはその後の「ただし〜」の段落だ。

<q lang="en">when it is used as a placeholder which will later be filled in by a script</q> だから要素内が空でもいい、はわかる。しかし <q lang="en">when the element is part of a template and would on most pages be filled in but on some pages is not relevant</q> だから要素内が空でもいい、はちょっとよくわからない。一部のページで関係がないなら、その時は要素ごと出力しないようにすべきだろう。それがテンプレートというものでは？　後方互換性のためにこうなっているのだろうか。

まぁとりあえずこのなるほだない段落に関しては、スクリプトの支援を受けるためやテンプレート処理の出力結果として要素内が空になっててもいいですよということだろう。いいのかよ。

どちらかというと「その場合に空になっていい」ではなくて「空になる場合があるなら、空にならざるを得ないから、空でいい」なのかなと*感じた*。

前提としては触知可能な要素が入る作りをしておき、その上であらかじめ空にしておかなくてはならない場合と、機械的に空になってしまう場合だけ、パルパブルコンテンツの要素内が空であることが認められる、ということなのだろう。機械的に仕方がなく中身が空になったパルパブルコンテンツは、即ちに仕様違反とはならないけどね、という*感じ*。

原文の最後の段落は……言うは易し行うは難しすぎるだろう。lint にかけられた HTML に中身が空のパツパブルコンテンツがあったとして、それがスクリプト支援のためとかテンプレートの出力結果でそうなっていることをどうやってツールに理解させられるだろうか？　複数画面にまたいだコンテンツ仕様を機械が知っていろ、と言っているに等しい。そんなツールがあるならぜひ使いたいが、現実としてそんなツールはない。

それがエラーであると判断できないゆえに、主要なチェックツールは `<div></div>` や `<span></span>` にエラー吐かないのだとしたら、我々は仕様書の無理な要求に答えられないツールによって認知を歪められているということだ。全員ダメか。

## 結論 1

やはり表題の通り、div 要素と span 要素は中身を空にできないが、空になってしまうのは良いというのが仕様から読み取れる結論だった。

ただしレイアウト目的や装飾目的で中身を空にしておくのは妥当ではないだろう。スクリプトで中身が挿入されることもないし、かろうじてテンプレートのせいだと言い張れたとしても、何かの中身が挿入されているページがどこにもなければ、それはパルパブルコンテンツの仕様に反する。

逆に言えば、スクリプトで中身を挿入されることがある要素や、他のページでは中身があるけど特定のページでは空になる div や span であれば、その時だけその要素をレイアウト目的や装飾目的に使っても構わないということになる。

その要素の中身がある場合とない場合があり、中身があってもなくても要素を出力しなければならない or 出力されてしまう要素……。あるだろうか？　あったとしても限定的すぎて汎用的には使えない。じゃあ俺たちは一体なんの要素で空 ◯◯ を作ればいいんだ？

## なんの意味も持たない妥当な空の要素を求めて

リアルワールドではどう考えたって、なんの意味も持たない、レイアウトや装飾目的の空の要素は必要だ。そうでなければ spacer.gif だけが俺たちの唯一の救いになってしまう。そんなことが許されていいはずがない。

ところで、仕様を再度確認すると <q lang="en">As a general rule, elements whose content model allows any [flow content](https://html.spec.whatwg.org/multipage/dom.html#flow-content-2) or [phrasing content](https://html.spec.whatwg.org/multipage/dom.html#phrasing-content-2) should have ~</q> という書き出しになっているが、パルパブルコンテンツに属す要素のうち、コンテンツモデルがフローコンテンツでもフレージングコンテンツでもないものについての言及がない。

もしかしたら、div や span ではない要素で、中身を空にしても仕様上妥当な要素があるかもしれないので一覧にしてみる。

<div class="table--post111">

| パルパブルコンテンツ<br>に属す要素                           | 要素のコンテンツモデル           | 要素固有の特性                                                                                                                                                                                                                     |
| -------------------------------------------------------- | -------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| a                                                        | トランスペアレント               | インタラクティブ要素、a 要素、tabindex 属性を持つ要素は内包できない。a 要素が href 属性を持つ場合はインタラクティブコンテンツに属する。                                                                                            |
| abbr                                                     | フレージングコンテンツ           | 略語を表し、title 属性を使って完全な用語や拡張した略語を示せる                                                                                                                                                                     |
| address                                                  | フローコンテンツ                 | 見出し要素、セクショニング要素、header 要素、footer 要素、address 要素を内包できない。                                                                                                                                             |
| article                                                  | フローコンテンツ                 |                                                                                                                                                                                                                                    |
| aside                                                    | フローコンテンツ                 |                                                                                                                                                                                                                                    |
| controls 属性を持つ audio                                | トランスペアレント               | メディア要素は内包できない。0 個以上の track 要素が内包できる。src 属性がある場合、前述に加えて 0 個以上の source 要素が内包できる。                                                                                               |
| b                                                        | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| bdi                                                      | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| bdo                                                      | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| blockquote                                               | フローコンテンツ                 | セクショニングルートにも属す。cite 属性で引用のソースや詳細へのリンクを示せる。                                                                                                                                                    |
| button                                                   | フレージングコンテンツ           | インタラクティブ要素と tabindex 属性を持つ要素は内包できない。                                                                                                                                                                     |
| canvas                                                   | トランスペアレント               | インタラクティブ要素を内包できるが、a 要素、usemap 属性を持つ img 要素、button 要素、チェックボックスの input 要素、ラジオボタンの input 要素、multiple 属性を持つ select 要素は除く。また、1px 以上で表示されるものを内包できる。 |
| cite                                                     | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| code                                                     | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| data                                                     | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| details                                                  | フローコンテンツ                 | 1 つの summary 要素も内包できる                                                                                                                                                                                                    |
| dfn                                                      | フレージングコンテンツ           | dfn を内包できない（入れ子にできない）                                                                                                                                                                                             |
| div                                                      | フローコンテンツ                 | dl 要素の子要素になっている場合は、1 つ以上の dt 要素と 1 つ以上の dd を内包する。                                                                                                                                                 |
| 少なくとも 1 つの<br> dt と dd のセットが<br>含まれている dl | -                                | 1 つ以上の dt と dd のセット、もしくは 1 つ以上の div 要素を内包できる                                                                                                                                                             |
| em                                                       | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| embed                                                    | nothing                          |                                                                                                                                                                                                                                    |
| fieldset                                                 | フローコンテンツ                 | legend 要素も内包できる                                                                                                                                                                                                            |
| figure                                                   | フローコンテンツ                 | フローコンテンツを内包する figcaption を 1 つ内包できる。また、1 つの figcaption を内包するフローコンテンツも内包できる。                                                                                                          |
| footer                                                   | フローコンテンツ                 | header 要素と footer 要素は内包できない。                                                                                                                                                                                          |
| form                                                     | フローコンテンツ                 | form 要素は内包できない（入れ子にできない）                                                                                                                                                                                        |
| h1,h2,h3,h4,h5,h6                                        | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| header                                                   | フローコンテンツ                 | header 要素と footer 要素は内包できない。                                                                                                                                                                                          |
| hgroup                                                   | -                                | 1 つ以上の h1,h2,h3,h4,h5,h6 要素を内包できる。hgroup 要素は内包できない（入れ子にできない）                                                                                                                                       |
| i                                                        | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| iframe                                                   | nothing                          |                                                                                                                                                                                                                                    |
| img                                                      | nothing                          |                                                                                                                                                                                                                                    |
| type="hidden"ではない input                              | nothing                          |                                                                                                                                                                                                                                    |
| ins                                                      | トランスペアレント               | cite 属性で引用のソースや詳細へのリンクを示せる。datetime 属性で変更日時を示せる。                                                                                                                                                 |
| kbd                                                      | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| label                                                    | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| main                                                     | フローコンテンツ                 |                                                                                                                                                                                                                                    |
| map                                                      | トランスペアレント               |                                                                                                                                                                                                                                    |
| mark                                                     | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| MathML math                                              | 未調査                           |                                                                                                                                                                                                                                    |
| 1 つ以上の li 要素を持つ menu                            | -                                | li 要素を内包できる                                                                                                                                                                                                                |
| meter                                                    | フレージングコンテンツ           | meter 要素は内包できない（入れ子にできない）                                                                                                                                                                                       |
| nav                                                      | フローコンテンツ                 |                                                                                                                                                                                                                                    |
| object                                                   | トランスペアレント               | 0 個以上の param 要素を内包できる                                                                                                                                                                                                  |
| 1 つ以上の li 要素を持つ ol                              | -                                | li 要素を内包できる                                                                                                                                                                                                                |
| output                                                   | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| p                                                        | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| pre                                                      | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| progress                                                 | フレージングコンテンツ           | progress 要素は内包できない（入れ子にできない）                                                                                                                                                                                    |
| q                                                        | フレージングコンテンツ           | cite 属性で引用のソースや詳細へのリンクを示せる。datetime 属性で変更日時を示せる。                                                                                                                                                 |
| ruby                                                     | フレージングコンテンツ           | ややこしかったので割愛。[仕様](https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-ruby-element)を参照してください。                                                                                              |
| s                                                        | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| samp                                                     | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| section                                                  | フローコンテンツ                 |                                                                                                                                                                                                                                    |
| select                                                   | -                                | 0 個以上の option 要素か optgroup 要素を内包できる                                                                                                                                                                                 |
| small                                                    | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| span                                                     | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| strong                                                   | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| sub                                                      | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| sup                                                      | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| svg                                                      | 未調査                           | Super Very Good!                                                                                                                                                                                                                   |
| table                                                    | -                                | 1 つの caption,0 個以上の colgroup,1 つの thead,0 個以上の tbody,1 つの tfoot,1 つ以上の tr を内包できる。                                                                                                                         |
| textarea                                                 | テキスト                         | HTML 要素は内包できない                                                                                                                                                                                                            |
| time                                                     | フレージングコンテンツ,<br>テキスト | datetime 属性を持っていればフレージングコンテンツを内包できる。属性がない場合はテキストを内包で切る。                                                                                                                              |
| u                                                        | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| 1 つ以上の li 要素を持つ ul                              | -                                | li 要素を内包できる                                                                                                                                                                                                                |
| var                                                      | フレージングコンテンツ           |                                                                                                                                                                                                                                    |
| video                                                    | トランスペアレント               | メディア要素は内包できない。0 個以上の track 要素が内包できる。src 属性がある場合、前述に加えて 0 個以上の source 要素が内包できる。                                                                                               |
| 要素間の空白でないテキスト                               | -                                | パルパブルコンテンツには空白は入れられない                                                                                                                                                                                         |
| 自律的なカスタムエレメント                               | ?                                |                                                                                                                                                                                                                                    |

</div>

MathML math 要素と svg 要素のコンテンツモデルは未調査。このうち、コンテンツモデルがフローコンテンツでもフレージングコンテンツでもないものは次の通り。

- a
- audio
- canvas
- dl
- embed
- hgroup
- iframe
- img
- type=hidden ではない input
- ins
- math
- object
- ol
- svg
- table
- textarea
- ul
- video
- テキスト
- 自律的なカスタムエレメント

さらにこの中で空要素ではないものは次の通り。

- a
- audio
- canvas
- dl
- hgroup
- iframe
- ins
- math
- object
- ol
- svg
- table
- textarea
- ul
- video
- テキスト
- 自律的なカスタムエレメント

それから、内容物を含める必要がないものは次の通り。

- a
- audio
- canvas
- iframe
- object
- textarea
- video
- 自律的なカスタムエレメント

この中で目的を達成できる可能性があるのものは「自律的なカスタムエレメント」だけであろう。他は属性と値を必要とし、あるとコンテンツになってしまうしのでレイアウトや装飾目的には使えない。属性値がなければパルパブルではなくなるので仕様違反になる。

パルパブルコンテンツに属す要素で、コンテンツモデルがフローコンテンツでもフレージングコンテンツでもないものについて言及がなかったのは、それらが

- 空要素なのでそもそも内容物を入れられない
- その要素に中身がなくても属性値によって触知可能なコンテンツとして成立する
- その要素自体のルールで中身を空にできない

のいずれかに当てはまるからということなのかもしれない。自明なので、というやつだ。

改めて、中身を空にできる要素の方全然ないのだなと感心した。ol, ul, menu は li 要素が 1 つもない場合に*パルパブルコンテンツではなくなる*のだけど、かといってリスト要素であることには違いないので、空 div や空 span の代替にはならない。

[HTML Standard - 4.4.5 The ol element](https://html.spec.whatwg.org/multipage/grouping-content.html#the-ol-element)

## 結論 2

というわけで、レイアウトや装飾を目的として中身のない div 要素や span 要素を作ることはできない俺たちに残された唯一の要素は自律的なカスタムエレメントとなった。使おう！自律的なカスタムエレメント！

## 自律的なカスタムエレメントを使う

というわけで使ってみる。ここでは、レイアウトや装飾目的の空 div を代替する虚無な要素を `<void-fill>` というタグ名で作っていく。本当は `void` とか `empty`とか `spacer`のような一語のタグにしたいが、カスタムエレメントは名前にハイフンを含めなくてはならないのでそれはできない。

[HTML Standard - 4.13.3 Core consepts - valid custom element name](https://html.spec.whatwg.org/multipage/custom-elements.html#valid-custom-element-name)

カスタムエレメントは JavaScript で定義する。

```javascript
class VoidFill extends HTMLElement {}
customElements.define("void-fill", VoidFill);
```

`HTMLElement` クラスを `extends` した `VoidFill` クラスを定義して `customElements.difine()` で引き当てているだけだ。この時、`.define()` で `extends` オプションを渡さないことで*自律的な*カスタムエレメントとして定義される。

<aside>
自律的なカスタムエレメントではないカスタムエレメント、つまり <code>.define()</code> に <code>extends</code> オプションをつける場合、ネイティブのHTML要素から機能を拡張するのだけど、コンテンツモデルやカテゴリーはおそらくそれを引き継ぐことになると思われる。例えば div 要素から拡張するならば、

<pre><code class="language-javascript">class VoidFill extends HTMLDivElement {
  constructor() {
    super();
  }
}

customElements.define(
  &quot;void-fill&quot;,
  VoidFill,
  { extends: &quot;div&quot; }
);
</code></pre>

こう。 class の拡張時点で HTMLDivElement から extends し、customElements.define() でも div を extends していると明示する。ルー語か？

これで div 要素のインターフェースを引き継いだ void-fill 要素が作られる。しかし div 要素は中身を空にできないので、今回は extends オプションは使わない「自律的なカスタムエレメント」で代替したというわけだ。
</aside>

HTML 側では普通に要素として記述し、適宜 CSS クラスを振っておく。

```html
<void-fill class="h3r"></void-fill>
```

CSS 側は特に変わったことはないが、ハイフン込みの要素名は要素セレクタとして正常に機能し、詳細度も 0.0.1 で計算される。

```css
void-fill {
  display: block;
}

.h3r {
  height: 3rem;
}
```

終わり。小さく使う分には何も難しいことはないように思った。

通常であれば、カスタムエレメントにはもっとたくさんの機能を付与するだろう。しかし今回は空 div の代替なので小難しいことはナシでいける。

カスタムエレメントに属性値を渡し、内部プロパティでスタイルとして設定しても良いだろう。そうすれば CSS ファイルには記述は不要になる。

レイアウト目的であればそれでいいかもしれないが、例えばハンバーガーアイコンの棒をカスタムエレメントで代替しようとすると、その時はあくまでハンバーガーアイコンというコンポーネントの一部として管理したいだろうから、そこだけスタイルの管理が CSS ファイルから JS 内部に移ってしまうような設計が好ましいかは議論の余地がある。

カスタムエレメントにどこまで委譲するかは、コード全体の設計やチームの開発フローに依るところも大きいだろう。

## まとめ

ということで、div 要素や span 要素は中身を空にできないが、機械の都合で空になってしまう場合は認められているし、チェックツールはそれを判断できないのでエラーを吐かない。

中身が空になっていい要素の中で、空 div や空 span を代替できるものは自律的なカスタムエレメントだけであり、カスタムエレメントを小さく使うのはかなり簡単なので、明示的に中身のない要素が欲しい場合は自律的なカスタムエレメントを使おう。

dskd でも要素間の空白に空の div を使っているので、遠からずカスタムエレメントに置き換えたいと思う。

なのだけど、明示的に中身がない div や span だって特に断りなく仕様で認められてもいいんじゃないかとは思う。なんで機械がやるのは認めていて、人がやるのはだめなんです？　その機械を書いているのは人なのに！

ついでに、中に dt と dd があれば `dl > div` もありとなったならば、`select > div` や `ol > div` `ul > div` もありにしてほしい。いいでしょそんくらい！

誰か WHATWG にプルリクお願いします。
