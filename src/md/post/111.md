---
layout: ./src/html/post.pug
page_type: "post"
page_datetime: "2021-03-25T09:48:17"
page_id: "111"
page_tag:
  - "HTML"
page_cover: ""
page_description: "はっきりせい"
page_title: "div要素やspan要素は中身が空になってもいいが、レイアウトや装飾目的で中身を空にしていいかはハッキリしていない"
---

レイアウトや装飾目的で中身のない div 要素や span 要素、いわゆる「空 div」「空 span」を作ることはままある。しかしそれは仕様に照らし合わせて妥当なのだろうか？　結論は表題の通りなのだが、一旦この記事にお付き合いいただきたい。

---

現在、唯一の HTML 仕様となった WHATWG HTML Standard では、div 要素のカテゴリーは「フローコンテンツ」と「パルパブルコンテンツ」である。

[HTML Standard - 4.4.15 The div element](https://html.spec.whatwg.org/multipage/grouping-content.html#the-div-element)

span 要素のカテゴリーは「フローコンテンツ」と「フレージングコンテンツ」と「パルパブルコンテンツ」である。

[HTML Standard - 4.5.26 The span element](https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-span-element)

コンテンツモデルとは、その要素がなんの要素やどんなテキストを内包できるかを定義したものである。似た特性は 1 つのグループにまとめられており、先述の「フローコンテンツ」とか「パルパブルコンテンツ」とかはそのうちの 1 つである。他のグループは次のリンク先で確認できる。どのグループにも含まれない固有のコンテンツモデルが指定されている要素もある。その場合グループ名は使われず、コンテンツモデルとなる条件を文章で解説していることが多い。

[HTML Standard - 3.2.5.2 Kinds of content](https://html.spec.whatwg.org/multipage/dom.html#kinds-of-content)

カテゴリーとは、その要素がどのコンテンツモデルに属しているかを定義したものである。複数のカテゴリーに属する要素もあるし、どのカテゴリーにも属さない要素もある。属するカテゴリーで語られるコンテンツモデルは、必然的にグルーピングされたコンテンツモデルになっている。名前がついていないコンテンツモデルに「属している」とは定義できないからであろう。

属するカテゴリーと内包できるコンテンツモデル、そしてその要素自身の特性によって、例えば title 要素では「head 要素内にしか書けない」「title 要素はドキュメント内に 1 つだけ」「内容物が空白文字のみは認められない」とかいう仕様を説明できるようになる。

属するものの説明と内包できるものの説明の両方でコンテンツモデルという言葉が使われているのがややこしい。

<aside>

[W3C 発行の HTML がすべて廃止された日 | フロントエンド Blog | ミツエーリンクス](https://www.mitsue.co.jp/knowledge/blog/frontend/202102/08_0910.html)の記事にある通り、W3C が過去に発行した HTML の仕様は全て廃止され、WHATWG の HTML Standard だけが有効な HTML 仕様となっている。ブラウザをはじめとする UA が廃止された仕様をどのように扱うかはベンダー次第と言ったところだろうが、ともかく今後も HTML サポートをするとなった場合に参照される仕様書は WHATWG のものとなるわけで、ウェブサイト制作に携わる者も同じく WHATWG の HTML Standard に基づいて物事を判断していかなくてはならない。

</aside>

## フローコンテンツ

フローコンテンツの仕様を原文と意訳を併記してみた。引用ブロックが原文、ダブルクォーテーションが意訳である。

[HTML Standard - 3.2.5.2.2 Flow content](https://html.spec.whatwg.org/multipage/dom.html#phrasing-content)

> Most elements that are used in the body of documents and applications are categorized as flow content.

“ドキュメントの本文で使われるほとんどの要素はフローコンテンツに属している。”

> → `a`, `abbr`, `address`, `area` (if it is a descendant of a `map` element), `article`, `aside`, `audio`, `b`, `bdi`, `bdo`, `blockquote`, `br`, `button`, `canvas`, `cite`, `code`, `data`, `datalist`, `del`, `details`, `dfn`, `dialog`, `div`, `dl`, `em`, `embed`, `fieldset`, `figure`, `footer`, `form`, `h1`, `h2`, `h3`, `h4`, `h5`, `h6`, `header`, `hgroup`, `hr`, `i`, `iframe`, `img`, `input`, `ins`, `kbd`, `label`, `link` (if it is [allowed in the body](https://html.spec.whatwg.org/multipage/semantics.html#allowed-in-the-body)), `main` (if it is a [hierarchically correct `main` element](https://html.spec.whatwg.org/multipage/grouping-content.html#hierarchically-correct-main-element)), `map`, `mark`, [MathML `math`](https://www.w3.org/Math/draft-spec/chapter2.html#interf.toplevel), `menu`, `meta` (if the `itemprop` attribute is present), `meter`, `nav`, `noscript`, `object`, `ol`, `output`, `p`, `picture`, `pre`, `progress`, `q`, `ruby`, `s`, `samp`, `script`, `section`, `select`, `slot`, `small`, `span`, `strong`, `sub`, `sup`, [SVG `svg`](https://svgwg.org/svg2-draft/struct.html#SVGElement), `table`, `template`, `textarea`, `time`, `u`, `ul`, `var`, `video`, `wbr`, [autonomous custom elements](https://html.spec.whatwg.org/multipage/custom-elements.html#autonomous-custom-element), [text](https://html.spec.whatwg.org/multipage/dom.html#text-content)

ここは訳はいらないだろう。着目すべきは最後の「text」部分。これは後述、先にフレージングコンテンツを見ていく。

## フレージングコンテンツ

[HTML Standard - 3.2.5.2.5 Phrasing content](https://html.spec.whatwg.org/multipage/dom.html#phrasing-content)

> Phrasing content is the text of the document, as well as elements that mark up that text at the intra-paragraph level. Runs of [phrasing content](https://html.spec.whatwg.org/multipage/dom.html#phrasing-content-2) form [paragraphs](https://html.spec.whatwg.org/multipage/dom.html#paragraph).

"フレーズコンテンツはドキュメントのテキストで、段落内のレベルでそのテキストをマークアップする要素でもある。一連のフレージングコンテンツが段落を形成する。"

> → `a`, `abbr`, `area` (if it is a descendant of a `map` element), `audio`, `b`, `bdi`, `bdo`, `br`, `button`, `canvas`, `cite`, `code`, `data`, `datalist`, `del`, `dfn`, `em`, `embed`, `i`, `iframe`, `img`, `input`, `ins`, `kbd`, `label`, `link` (if it is [allowed in the body](https://html.spec.whatwg.org/#allowed-in-the-body)), `map`, `mark`, [MathML `math`](https://www.w3.org/Math/draft-spec/chapter2.html#interf.toplevel), `meta` (if the `itemprop` attribute is present), `meter`, `noscript`, `object`, `output`, `picture`, `progress`, `q`, `ruby`, `s`, `samp`, `script`, `select`, `slot`, `small`, `span`, `strong`, `sub`, `sup`, [SVG `svg`](https://svgwg.org/svg2-draft/struct.html#SVGElement), `template`, `textarea`, `time`, `u`, `var`, `video`, `wbr`, [autonomous custom elements](https://html.spec.whatwg.org/#autonomous-custom-element), [text](https://html.spec.whatwg.org/#text-content)

いろいろ書いてあるがここでも最後に「text」がある。

> Note: Most elements that are categorized as phrasing content can only contain elements that are themselves categorized as phrasing content, not any flow content.

"フレージングコンテンツに属する要素のほとんどは、フレージングコンテンツに属する要素だけを内包でき、フローコンテンツは内包できない。"

ここまで見ると、フローコンテンツは自身を入れ子にできるしフレージングコンテンツも自身を入れ子にできるが、フレージングコンテンツの中にフローコンテンツは入れらないとわかる。 `div > div`、 `div > span`、 `span > span` はできるが `span > div` はできないとなる。

## コンテンツモデルにおける text

そして <q lang="en">text</q> について。これにもちゃんと定義がある。

[HTML Standard - 3.2.5.2.5 Phrasing Content - Text](https://html.spec.whatwg.org/multipage/dom.html#text-content)

> Text, in the context of content models, means either nothing, or `Text` nodes. [Text](https://html.spec.whatwg.org/multipage/dom.html#text-content) is sometimes used as a content model on its own, but is also [phrasing content](https://html.spec.whatwg.org/multipage/dom.html#phrasing-content-2), and can be [inter-element whitespace](https://html.spec.whatwg.org/multipage/dom.html#inter-element-whitespace) (if the `Text` nodes are empty or contain just [ASCII whitespace](https://infra.spec.whatwg.org/#ascii-whitespace)).

“コンテンツモデル文脈におけるテキストは、何もないか、またはテキストノードを意味する。テキストはそれ自体でコンテンツモデルとして使われることがあるが、さらにフレージングコンテンツでもあり、要素間の空白になることもできる（テキストノードが空であるか、ただの ASCII 空白文字の場合）”

> `Text` nodes and attribute values must consist of [scalar values](https://infra.spec.whatwg.org/#scalar-value), excluding [noncharacters](https://infra.spec.whatwg.org/#noncharacter), and [controls](https://infra.spec.whatwg.org/#control) other than [ASCII whitespace](https://infra.spec.whatwg.org/#ascii-whitespace). This specification includes extra constraints on the exact value of `Text` nodes and attribute values depending on their precise context.

ここは難しいな……。

“テキストノードと属性値は、noncharactor と ASCII 空白文字以外の制御文字を除くスカラー値で構成されている必要がある。この仕様には、的確な文脈に応じたテキストノードと属性値の正確な値に対する追加の制約が含まれている。”

noncharactor と ASCII 空白文字以外の制御文字は、テキストノードと属性値にしてはいけないと読める。“的確な文脈に応じた〜追加の制約が含まれている” とはテキストノードや属性値に記述できる文字は要素や属性によって別のルールが追加されることもあるよという話だろうか？　簡単なところだと `href`に指定できる文字列には確かに「noncharactor と ASCII 空白文字以外の制御文字」の他にも、リンクとして有効な文字列であるという制約がある。そういう話だよね？　解釈が違っていたら教えてください……。

とりあえず、ASCII 空白文字ならテキストノードとして扱えるということがわかる。ASCII 空白文字の定義は、

[Infra Standard - 4.5. Code Poinsts - ASCII Whitespace](https://infra.spec.whatwg.org/#ascii-whitespace)

> ASCII whitespace is U+0009 TAB, U+000A LF, U+000C FF, U+000D CR, or U+0020 SPACE.

“ASCII 空白文字とは、タブ記号、LF 改行コード、フォームフィード、キャリッジリターン、半角スペースである。”

とのことなので、それらがフローコンテンツやフレージングコンテンツに内包してよい空白の定義となる。

<aside>

### "nothing" コンテンツモデル

ちなみに今回の div や span の話とは関係ないが、テキストを何も内包できない場合は "nothing" と書かれる。これは「"nothing" コンテンツモデル」という名前で定義されている。

[HTML Standard - 3.2.5.1 The "nothing" content model](https://html.spec.whatwg.org/multipage/dom.html#the-nothing-content-model)

> When an element's content model is nothing, the element must contain no `Text` nodes (other than [inter-element whitespace](https://html.spec.whatwg.org/multipage/dom.html#inter-element-whitespace)) and no element nodes.

“コンテンツモデルが "nothing" である要素は、要素間の空白文字以外、テキストノードも要素も含んではならない。”

> Note: Most HTML elements whose content model is "nothing" are also, for convenience, void elements (elements that have no end tag in the HTML syntax). However, these are entirely separate concepts.

“便宜上、コンテンツモデルが "nothing" である HTML 要素のほとんどは、HTML 構文で終了タグを持たない空要素である。ただしこれは完全に別の概念である。”

"nothing" コンテンツモデルである要素はだいたいが空要素なんだけど、空要素と "nothing" コンテンツモデルは別の世界観の話だよ、ということメモかな。

</aside>

## パルパブルコンテンツ

次にパルパブルコンテンツについて見てみる。

[HTML Standard - 3.2.5.2.8 Palpable content](https://html.spec.whatwg.org/multipage/dom.html#palpable-content)

> As a general rule, elements whose content model allows any [flow content](https://html.spec.whatwg.org/multipage/dom.html#flow-content-2) or [phrasing content](https://html.spec.whatwg.org/multipage/dom.html#phrasing-content-2) should have at least one node in its [contents](https://html.spec.whatwg.org/multipage/dom.html#concept-html-contents) that is palpable content and that does not have the `hidden` attribute specified.

“原則として、パルパブルコンテンツのカテゴリーに属する要素のコンテンツモデルが、フローコンテンツかフレージングコンテンを許容する場合は、その中身には触知可能なコンテンツが最低でも 1 つ含まれなくてはならないし、そのコンテンツに hidden 属性があってはならない。”

> Note: [Palpable content](https://html.spec.whatwg.org/multipage/dom.html#palpable-content-2) makes an element non-empty by providing either some descendant non-empty [text](https://html.spec.whatwg.org/multipage/dom.html#text-content), or else something users can hear (`audio` elements) or view (`video` or `img` or `canvas` elements) or otherwise interact with (for example, interactive form controls).

“パルパブルコンテンツは、読む・聞く・見る・入力するのいずれかができる要素を提供するので空にならない。”

> This requirement is not a hard requirement, however, as there are many cases where an element can be empty legitimately, for example when it is used as a placeholder which will later be filled in by a script, or when the element is part of a template and would on most pages be filled in but on some pages is not relevant.

“ただし、例えばあとからスクリプトで挿入するためのプレースホルダーや、テンプレートとしてほとんどのページで使われるが一部のページでは関連性がないなど、要素が正当に空になる可能性がある場合が多いので、これは難しい要件ではない。”

> Conformance checkers are encouraged to provide a mechanism for authors to find elements that fail to fulfill this requirement, as an authoring aid.

“チェックツールは要素が合法的に空であるのかそうでないのかを検出する機能を提供することを推奨する。”

> The following elements are palpable content:
> `a`, `abbr`, `address`, `article`, `aside`, `audio` (if the `controls` attribute is present), `b`, `bdi`, `bdo`, `blockquote`, `button`, `canvas`, `cite`, `code`, `data`, `details`, `dfn`, `div`, `dl` (if the element's children include at least one name-value group), `em`, `embed`, `fieldset`, `figure`, `footer`, `form`, `h1`, `h2`, `h3`, `h4`, `h5`, `h6`, `header`, `hgroup`, `i`, `iframe`, `img`, `input` (if the `type` attribute is _not_ in the [Hidden](<https://html.spec.whatwg.org/multipage/input.html#hidden-state-(type=hidden)>) state), `ins`, `kbd`, `label`, `main`, `map`, `mark`, [MathML `math`](https://www.w3.org/Math/draft-spec/chapter2.html#interf.toplevel), `menu` (if the element's children include at least one `li` element), `meter`, `nav`, `object`, `ol` (if the element's children include at least one `li` element), `output`, `p`, `pre`, `progress`, `q`, `ruby`, `s`, `samp`, `section`, `select`, `small`, `span`, `strong`, `sub`, `sup`, [SVG `svg`](https://svgwg.org/svg2-draft/struct.html#SVGElement), `table`, `textarea`, `time`, `u`, `ul` (if the element's children include at least one `li` element), `var`, `video`, [autonomous custom elements](https://html.spec.whatwg.org/multipage/custom-elements.html#autonomous-custom-element), [text](https://html.spec.whatwg.org/multipage/dom.html#text-content) that is not [inter-element whitespace](https://html.spec.whatwg.org/multipage/dom.html#inter-element-whitespace)> `a`, `abbr`, `address`, `article`, `aside`, `audio` (if the `controls` attribute is present), `b`, `bdi`, `bdo`, `blockquote`, `button`, `canvas`, `cite`, `code`, `data`, `details`, `dfn`, `div`, `dl` (if the element's children include at least one name-value group), `em`, `embed`, `fieldset`, `figure`, `footer`, `form`, `h1`, `h2`, `h3`, `h4`, `h5`, `h6`, `header`, `hgroup`, `i`, `iframe`, `img`, `input` (if the `type` attribute is _not_ in the [Hidden](<https://html.spec.whatwg.org/multipage/input.html#hidden-state-(type=hidden)>) state), `ins`, `kbd`, `label`, `main`, `map`, `mark`, [MathML `math`](https://www.w3.org/Math/draft-spec/chapter2.html#interf.toplevel), `menu` (if the element's children include at least one `li` element), `meter`, `nav`, `object`, `ol` (if the element's children include at least one `li` element), `output`, `p`, `pre`, `progress`, `q`, `ruby`, `s`, `samp`, `section`, `select`, `small`, `span`, `strong`, `sub`, `sup`, [SVG `svg`](https://svgwg.org/svg2-draft/struct.html#SVGElement), `table`, `textarea`, `time`, `u`, `ul` (if the element's children include at least one `li` element), `var`, `video`, [autonomous custom elements](https://html.spec.whatwg.org/multipage/custom-elements.html#autonomous-custom-element), [text](https://html.spec.whatwg.org/multipage/dom.html#text-content) that is not [inter-element whitespace](https://html.spec.whatwg.org/multipage/dom.html#inter-element-whitespace)

“次の要素が触知可能なコンテンツである: a, abbr, address, article, aside, audio（controls 属性があれば）, b, bdi, bdo, blockquote, button, canvas, cite, code, data, details, dfn, div, dl（子要素に少なくとも 1 つの dt と dd のグループがあれば）, em, embed, fieldset, figure, footer, form, h1, h2, h3, h4, h5, h6, header, hgroup, i, iframe, img, input（type 属性が hidden ではなければ）, ins, kbd, label, main, map, mark, MathML math, menu（少なくとも 1 つの li 要素があれば）, meter, nav, object, ol（少なくとも 1 つの li 要素があれば）, output, p, pre, progress, q, ruby, s, samp, section, select, small, span, strong, sub, sup, SVG svg, table, textarea, time, u, ul（少なくとも 1 つの li 要素があれば）, var, video, 自律的なカスタムエレメント、要素間のスペースではないテキスト”

## 触知可能なコンテンツを含むので空にならないが、ただし空になる可能性が多い場合がある……とは？

前半 2 つのパラグラフは特に問題なく理解できる。ある要素がパルパブルコンテンツであり、かつコンテンツモデルがフローコンテンツかフレージングコンテンツである場合は、中には意味のある何かが書かれている必要があるよ、その何かは hidden 属性が付いてたらだめだよ、その何かは読むか聞くか見るか入力するのどれかができる要素だよ、そういう要素が書かれているからパルパブルコンテンツの中身が空になることはないんだよ、という説明だろう。テキスト・音声・画像・動画・canvas・インタラクティブ要素をまとめて触知可能と言っているのはちょっとオシャレだなと思う。

後半の段落はちょっと引っかかる。

<q lang="en">This requirement is not a hard requirement, ~</q> と書かれているが、パルパブルコンテンツは空にならないという原則に対する例外として、<q lang="en">when it is used as a placeholder which will later be filled in by a script</q> だから空でもいい、はわかる。しかし <q lang="en">when the element is part of a template and would on most pages be filled in but on some pages is not relevant</q> だから要素内が空でもいい、はちょっとよくわからない。一部のページで関係がないなら、その時は要素ごと出力しないようにすべきだろう。それがテンプレートというものでは？　後方互換性のためにこうなっているのだろうか。

for example の他のパターンはどうなのだろうか。その直前で <q lang="en">there are many cases</q> と言っているし、挙げられている 2 パターン以外にも「正当に空になる」パターンは認められているだろうとは思う。しかし、レイアウトや装飾目的で空 div や空 span についてはハッキリ書かれておらず、モヤモヤする。

そして原文の最後の段落は……言うは易し行うは難しすぎるだろう。lint にかけられた HTML に中身が空のパルパブルコンテンツがあったとして、それがあとからスクリプトで挿入するためのプレースホルダーであることや、テンプレートの出力結果でそうなっていることを、どうやってツールに理解させられるだろうか？　複数画面にまたいだコンテンツ仕様を機械が知っていろ、と言っているに等しい。そんなツールがあるならぜひ使いたい。

## 結論 1

やはり表題の通り、div 要素と span 要素は中身になってもいい。原則として空にできないが正当に空にするのは良い。しかしレイアウトや装飾目的で中身を空にしていいかは判断がつかない。おそらくしていいように思うが、していいとハッキリ書かれていないので、してはいけないかもしれない。

レイアウトや装飾目的の空 div や空 span は、あとからスクリプトで挿入するためのプレースホルダーでもなければ、あるページでは触知可能な中身があるが一部のページでは中身がない、というような類のものではない。中身が常に空なのである。そういうのでも良いって書かれてないってことはダメってこと？？

では仮に、パルパブルコンテンツにおいて中身が常に空であることが認められない場合、俺たちは一体なんの要素で空 ◯◯ を作ればいいのだろうか。

## なんの意味も持たない妥当な空の要素を求めて

リアルワールドではどう考えたって、なんの意味も持たない、レイアウトや装飾目的の空の要素は必要だ。そうでなければ spacer.gif だけが俺たちの唯一の救いになってしまう。そんなことが許されていいはずがない。

ところで、仕様を再度確認すると <q lang="en">As a general rule, elements whose content model allows any [flow content](https://html.spec.whatwg.org/multipage/dom.html#flow-content-2) or [phrasing content](https://html.spec.whatwg.org/multipage/dom.html#phrasing-content-2) should have ~</q> という書き出しになっているが、パルパブルコンテンツに属す要素のうち、コンテンツモデルがフローコンテンツでもフレージングコンテンツでもないものについての言及がない。

もしかしたら div や span ではない要素で、中身を空にしても仕様上妥当な要素があるかもしれない。なので一覧にしてみた。コンテンツモデルのアルファベット表記の意味は下記の通り。

- P: フレージングコンテンツ
- F: フローコンテンツ
- T: トランスペアレント
- N: "nothing" コンテンツモデル

<div class="table--post111">

| パルパブルコンテンツに属す要素                               | コンテンツモデル | 要素固有の特性                                                                                                                                                                                                                     |
| ------------------------------------------------------------ | ---------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| a                                                            | T                | インタラクティブ要素、a 要素、tabindex 属性を持つ要素は内包できない。a 要素が href 属性を持つ場合はインタラクティブコンテンツに属する。                                                                                            |
| abbr                                                         | P                | 略語を表し、title 属性を使って完全な用語や拡張した略語を示せる。                                                                                                                                                                   |
| address                                                      | F                | 見出し要素、セクショニング要素、header 要素、footer 要素、address 要素を内包できない。                                                                                                                                             |
| article                                                      | F                |                                                                                                                                                                                                                                    |
| aside                                                        | F                |                                                                                                                                                                                                                                    |
| controls 属性を<br>持つ audio                                | T                | メディア要素は内包できない。0 個以上の track 要素が内包できる。src 属性がある場合、前述に加えて 0 個以上の source 要素が内包できる。                                                                                               |
| b                                                            | P                |                                                                                                                                                                                                                                    |
| bdi                                                          | P                |                                                                                                                                                                                                                                    |
| bdo                                                          | P                |                                                                                                                                                                                                                                    |
| blockquote                                                   | F                | セクショニングルートにも属す。cite 属性で引用のソースや詳細へのリンクを示せる。                                                                                                                                                    |
| button                                                       | P                | インタラクティブ要素と tabindex 属性を持つ要素は内包できない。                                                                                                                                                                     |
| canvas                                                       | T                | インタラクティブ要素を内包できるが、a 要素、usemap 属性を持つ img 要素、button 要素、チェックボックスの input 要素、ラジオボタンの input 要素、multiple 属性を持つ select 要素は除く。また、1px 以上で表示されるものを内包できる。 |
| cite                                                         | P                |                                                                                                                                                                                                                                    |
| code                                                         | P                |                                                                                                                                                                                                                                    |
| data                                                         | P                |                                                                                                                                                                                                                                    |
| details                                                      | F                | 1 つの summary 要素も内包できる                                                                                                                                                                                                    |
| dfn                                                          | P                | dfn を内包できない（入れ子にできない）                                                                                                                                                                                             |
| div                                                          | F                | dl 要素の子要素になっている場合は、1 つ以上の dt 要素と 1 つ以上の dd を内包する。                                                                                                                                                 |
| 少なくとも 1 つの<br> dt と dd のセットが<br>含まれている dl | -                | 1 つ以上の dt と dd のセット、もしくは 1 つ以上の div 要素を内包できる                                                                                                                                                             |
| em                                                           | P                |                                                                                                                                                                                                                                    |
| embed                                                        | N                |                                                                                                                                                                                                                                    |
| fieldset                                                     | F                | legend 要素も内包できる                                                                                                                                                                                                            |
| figure                                                       | F                | フローコンテンツを内包する figcaption を 1 つ内包できる。また、1 つの figcaption を内包するフローコンテンツも内包できる。                                                                                                          |
| footer                                                       | F                | header 要素と footer 要素は内包できない。                                                                                                                                                                                          |
| form                                                         | F                | form 要素は内包できない（入れ子にできない）                                                                                                                                                                                        |
| h1,h2,h3,h4,h5,h6                                            | P                |                                                                                                                                                                                                                                    |
| header                                                       | F                | header 要素と footer 要素は内包できない。                                                                                                                                                                                          |
| hgroup                                                       | -                | 1 つ以上の h1,h2,h3,h4,h5,h6 要素を内包できる。hgroup 要素は内包できない（入れ子にできない）                                                                                                                                       |
| i                                                            | P                |                                                                                                                                                                                                                                    |
| iframe                                                       | N                |                                                                                                                                                                                                                                    |
| img                                                          | N                |                                                                                                                                                                                                                                    |
| type="hidden"<br>ではない input                              | N                |                                                                                                                                                                                                                                    |
| ins                                                          | T                | cite 属性で引用のソースや詳細へのリンクを示せる。datetime 属性で変更日時を示せる。                                                                                                                                                 |
| kbd                                                          | P                |                                                                                                                                                                                                                                    |
| label                                                        | P                |                                                                                                                                                                                                                                    |
| main                                                         | F                |                                                                                                                                                                                                                                    |
| map                                                          | T                |                                                                                                                                                                                                                                    |
| mark                                                         | P                |                                                                                                                                                                                                                                    |
| MathML math                                                  | 未調査           |                                                                                                                                                                                                                                    |
| 1 つ以上の li 要素を<br>持つ menu                            | -                | li 要素を内包できる                                                                                                                                                                                                                |
| meter                                                        | P                | meter 要素は内包できない（入れ子にできない）                                                                                                                                                                                       |
| nav                                                          | F                |                                                                                                                                                                                                                                    |
| object                                                       | T                | 0 個以上の param 要素を内包できる                                                                                                                                                                                                  |
| 1 つ以上の li 要素を<br>持つ ol                              | -                | li 要素を内包できる                                                                                                                                                                                                                |
| output                                                       | P                |                                                                                                                                                                                                                                    |
| p                                                            | P                |                                                                                                                                                                                                                                    |
| pre                                                          | P                |                                                                                                                                                                                                                                    |
| progress                                                     | P                | progress 要素は内包できない（入れ子にできない）                                                                                                                                                                                    |
| q                                                            | P                | cite 属性で引用のソースや詳細へのリンクを示せる。datetime 属性で変更日時を示せる。                                                                                                                                                 |
| ruby                                                         | P                | ややこしかったので割愛。[仕様](https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-ruby-element)を参照してください。                                                                                              |
| s                                                            | P                |                                                                                                                                                                                                                                    |
| samp                                                         | P                |                                                                                                                                                                                                                                    |
| section                                                      | F                |                                                                                                                                                                                                                                    |
| select                                                       | -                | 0 個以上の option 要素か optgroup 要素を内包できる                                                                                                                                                                                 |
| small                                                        | P                |                                                                                                                                                                                                                                    |
| span                                                         | P                |                                                                                                                                                                                                                                    |
| strong                                                       | P                |                                                                                                                                                                                                                                    |
| sub                                                          | P                |                                                                                                                                                                                                                                    |
| sup                                                          | P                |                                                                                                                                                                                                                                    |
| svg                                                          | 未調査           | Super Very Good!                                                                                                                                                                                                                   |
| table                                                        | -                | 1 つの caption,0 個以上の colgroup,1 つの thead,0 個以上の tbody,1 つの tfoot,1 つ以上の tr を内包できる。                                                                                                                         |
| textarea                                                     | テキスト         | HTML 要素は内包できない                                                                                                                                                                                                            |
| time                                                         | P, テキスト      | datetime 属性を持っていればフレージングコンテンツを内包できる。属性がない場合はテキストを内包で切る。                                                                                                                              |
| u                                                            | P                |                                                                                                                                                                                                                                    |
| 1 つ以上の li 要素を<br>持つ ul                              | -                | li 要素を内包できる                                                                                                                                                                                                                |
| var                                                          | P                |                                                                                                                                                                                                                                    |
| video                                                        | T                | メディア要素は内包できない。0 個以上の track 要素が内包できる。src 属性がある場合、前述に加えて 0 個以上の source 要素が内包できる。                                                                                               |
| 要素間の<br />空白でないテキスト                             | -                | パルパブルコンテンツには空白は入れられない                                                                                                                                                                                         |
| 自律的な<br>カスタムエレメント                               | ?                |                                                                                                                                                                                                                                    |

</div>

MathML math 要素と svg 要素のコンテンツモデルは気力が尽きて未調査だがご容赦いただきたい。で、このうちコンテンツモデルがフローコンテンツでもフレージングコンテンツでもないものは次の通り。

- a
- audio
- canvas
- dl
- embed
- hgroup
- iframe
- img
- type="hidden" ではない input
- ins
- math
- object
- ol
- svg
- table
- textarea
- ul
- video
- テキスト
- 自律的なカスタムエレメント

さらにこの中で空要素ではないものは次の通り。

- a
- audio
- canvas
- dl
- hgroup
- iframe
- ins
- math
- object
- ol
- svg
- table
- textarea
- ul
- video
- テキスト
- 自律的なカスタムエレメント

それから、内容物を含める必要がないものは次の通り。

- a
- audio
- canvas
- iframe
- object
- textarea
- video
- 自律的なカスタムエレメント

この中で目的を達成できる可能性があるのものは「自律的なカスタムエレメント」だけであろう。他は属性と値が必要だし、付与するとコンテンツになってしまうしのでレイアウトや装飾目的には使えない。属性値がなければパルパブルではなくなるので仕様違反になる。

パルパブルコンテンツに属す要素で、コンテンツモデルがフローコンテンツでもフレージングコンテンツでもないものについて言及がなかったのは、それらが

- 空要素なのでそもそも内容物を入れられない
- その要素に中身がなくても属性値によって触知可能なコンテンツとして成立する（属性値が不正な場合はパルパブルでなくなる）
- その要素自体のルールで中身を空にできない

のいずれかに当てはまるからということなのかもしれない。自明なので、というやつだ。

改めて、中身を空にできる要素は全然ないのだと感心した。ol, ul, menu は li 要素が 1 つもない場合に*パルパブルコンテンツではなくなる*のだけど、かと言ってリスト要素であることには違いないので、空 div や空 span の代替にはならない。

[HTML Standard - 4.4.5 The ol element](https://html.spec.whatwg.org/multipage/grouping-content.html#the-ol-element)

## 結論 2

というわけで、レイアウトや装飾を目的として中身のない div 要素や span 要素を作ることは仕様上できないかもしれないと恐れる俺たちに残された唯一の要素は自律的なカスタムエレメントとなった。

使おう！　自律的なカスタムエレメント！

## 自律的なカスタムエレメントを使う

自身が余白となってコンポーネント同士の間に挿入されるような空 div を、代替する虚無な要素を `<void-fill>` というタグ名で作ってみよう。本当は `void` とか `empty`とか `spacer`のような一語のタグにしたいが、カスタムエレメントは未来の新要素との衝突を防ぐために名前にハイフンを含めなくてはならないのでそれはできない。

[HTML Standard - 4.13.3 Core consepts - valid custom element name](https://html.spec.whatwg.org/multipage/custom-elements.html#valid-custom-element-name)

カスタムエレメントは JavaScript で定義する。class 構文は ES2015 以降で使える記述なので、名前を言ってはいけない IE11 では動かない。

```javascript
class VoidFill extends HTMLElement {}
customElements.define("void-fill", VoidFill);
```

`HTMLElement` クラスを `extends` した `VoidFill` クラスを定義して `customElements.difine()` で引き当てているだけだ。この時、`.define()` で `extends` オプションを*渡さない*ことで自律的なカスタムエレメントとして定義される。class 内に何も記述しなくても動作するのですごい。

HTML 側では普通に要素として記述し、適宜 CSS クラスを振っておく。

```html
<void-fill class="h3r"></void-fill>
```

CSS 側は特に変わったことはない。ハイフン込みの要素名でも要素セレクタとして正常に機能し、詳細度も 0.0.1 で計算される。

```css
void-fill {
  display: block;
}

.h3r {
  height: 3rem;
}
```

終わり。小さく使う分には何も難しいことはないように感じる。サイズごとに CSS クラス名を作りたくないというならば、CSS のカスタムプロパティを使って、

```css
:root {
  --h: 1rem;
}

void-fill {
  display: block;
  height: var(--h);
}
```

とし、HTML 側の利用箇所で style 属性を使って

```html
<void-fill style="--h:3rem"></void-fill>
```

上書きしてやれば良いだろう。CodePen に動くデモを置いておいた。

<p class="codepen" data-height="385" data-theme-id="dark" data-default-tab="html,result" data-user="otiext" data-slug-hash="eYBqBEZ" style="height: 265px; box-sizing: border-box; display: flex; align-items: center; justify-content: center; border: 2px solid; margin: 1em 0; padding: 1em;" data-pen-title="Simple Custom Element Spacer">
  <span>See the Pen <a href="https://codepen.io/otiext/pen/eYBqBEZ">
  Simple Custom Element Spacer</a> by oti (<a href="https://codepen.io/otiext">@otiext</a>)
  on <a href="https://codepen.io">CodePen</a>.</span>
</p>
<script async src="https://cpwebassets.codepen.io/assets/embed/ei.js"></script>

なお CSS カスタムプロパティも名前を言ってはいけない IE11 では動かない。

<aside>
自律的なカスタムエレメントではないカスタムエレメント、つまり <code>.define()</code> に <code>extends</code> オプションをつける場合、ネイティブのHTML要素から機能を拡張するのだけど、コンテンツモデルやカテゴリーはを引き継ぐことになると思われる。例えば div 要素から拡張するならば、

<pre><code class="language-javascript">class VoidFill extends <mark>HTMLDivElement</mark> {
  constructor() {
    super();
  }
}
customElements.define(
  &quot;void-fill&quot;,
  VoidFill,
  <mark>{ extends: &quot;div&quot; }</mark>
);
</code></pre>

JS でこう。class の宣言で `HTMLElement` ではなく `HTMLDivElement` から `extends` して `customElements.define()` でも `div` を `extends` していると明示する。そして `constructor()` で `super()` を呼び出す必要がある。

さらに HTML で

<pre><code class="language-html">&lt;div <mark>is=&quot;void-fill&quot;</mark>&gt;&lt;div&gt;
</code></pre>

このように拡張元の div 要素を使いつつ、is 属性を使ってカスタムエレメント名を指定する。これで div 要素のインターフェースを引き継いだ void-fill 要素が作られる。しかし div 要素は中身を空にできないので、今回は `extends` オプションは使わない「自律的なカスタムエレメント」で代替したというわけだ。

</aside>

通常であれば、カスタムエレメントにはもっとたくさんの機能を付与するだろう。今回は空 div の代替なので小難しいことはナシでいける。

カスタムエレメントに属性値を渡し、内部プロパティでスタイルとして設定しても良いだろう。そうすれば CSS ファイルへの記述は不要になる。

ただ、レイアウト目的であればそれでいいかもしれないが、例えばハンバーガーアイコンの棒をカスタムエレメントで代替しようとすると、その時はあくまでハンバーガーアイコンというコンポーネントの一部として管理したいだろうから、そこだけスタイルの管理が CSS ファイルから JS 内部に移ってしまうような設計が好ましいかは議論の余地がある。

カスタムエレメントにどこまで委譲するかは、コード全体の設計やチームの開発フローに依るところも大きいだろう。

## まとめ

まとめると、

- div 要素や span 要素は中身を空にできないが、正当に空になるのは認められている
- レイアウトや装飾目的の空 div や空 span が正当な空の要素かどうかは仕様にはハッキリと書かれてはいない
- レイアウトや装飾目的の空 div や空 span をハッキリと代替できるのは自律的なカスタムエレメントだけである

仕様として明確にダメでもないが、明確に良いとも書かれていない。それがレイアウトや装飾目的の空 div や空 span となってしまっている。ハッキリしたものしか使えない現場の俺さんたちはカスタムエレメントを使おう。

とは言え実際のところ、空 div を使いたいシーンではカスタムエレメントなんていちいち定義していられないだろう。ハンバーガーアイコンの棒を一本引くのに JS を書くなど、たとえ記述が簡単であってもめんどくさい。その程度のことで JS に関心を持ちたくない。

せめて仕様の for example に「レイアウトや装飾目的で〜」と書かれてくれていれば……。div と span のコンテンツモデルに "nothing" が付け加えられるだけでもいい。中身が常に空でもいいんだよ、そのたった一言が欲しい。それだけで俺の世界は平和になる。さすれば HTML は CSS から解き放たれ、大地に深く根を張り、その身は雄々しく聳え立ち、俺に永遠の安らぎを与えるだろう。

だのにそれがないために、俺はこんな長文を書く病気にかかってしまった。治したい。

ついでに、中に dt と dd があれば `dl > div` もありとなったならば、`select > div` や `ol > div` `ul > div` もありにしてほしい。明らかにパルパブルだろうよ。

---

Special Thanks! [@cloud10designs](https://twitter.com/cloud10designs), [@GeckTang](https://twitter.com/geckotang), [@glatyou](https://twitter.com/glatyou), [@\_tsmd](https://twitter.com/_tsmd)!
